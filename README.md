**Welcome to LaunchPadango**

*A Theatre app for clients who would like to manage their movie theatre.*

Link: [launchpadango.herokuapp.com](http://launchpadango.herokuapp.com/)

Below I have written a summary of my approach in building this application:

While building the theatre application, I first thought about the models that I would need to create. I chose to create the theatre app with four models: Movie, Theatre, Showtime and Order. I created Movie and Theatre first as they are the attributes which belong to a showtime. I then created the order model which belongs to a movie, theatre and showtime. I first added foreign keys to orders for movies, theatres and showtimes but I chose to remove the foreign key constraints on orders in order to allow the deletion of a movie without deleting the orders (financial data). This seems like the best way to ensure the order data remains accurate. However, we still need movie and showtime attributes on the order so we are caching these attributes on the order when it is created. The order model contains basic logic for movie pricing, if the showtime is before 4 pm then the matinee pricing is applied of $11; If the showtime is after 4 pm then regular price, $15, is applied to the order. I also added custom validation to the order so as the customer I am not able to buy a ticket for a movie that is sold out. 

After building the models and adding the necessary validations I moved on to creating the controllers. The orders create controller caches the movie title, order showtime name and order showtime time. I ended up extracting some of the controller actions into an admin namespace for the admin dashboard. This sets us up to easily implement authentication in the future. This also allows us to render different views for the same actions, for example the home page is the MoviesController#index, which shows the movie cards, while the admin panel also has a Admin::MoviesController#index, which shows a table of movies with a link to destroy the record. 

When a user first goes to LaunchPadango they see a list of movies, which is the movies index page. Here each movie has its own card with the movie title, poster, a ‘Showtimes' link and a ‘Buy Ticket’ link. When the user clicks on the ‘Showtimes’ link a card flows up and shows the upcoming movie showtimes, which are showtimes from a range of the present time and two weeks from now. The showtimes card also shows the user if a movie is sold out. This is done by checking the Theatre capacity for that particular showtime, and subtracting the order count from that showtime, once the capacity hits zero a flag is added to the showtime display name saying ‘(sold out)’ and the showtime text color turns red. The user has the ability to click on the movie title, which takes them to the movie show page. Within this page the user is presented the movie poster, the movie synopsis and the rating. On this page I also added a call to action button to ‘Buy Ticket’ which allows the user to go to the order form directly, or they could go back to the movies index page and use the ‘buy ticket’ button on the card. 

The order form that the user is taken to is passed in a movie_id of the respected movie and will only display showtimes for that particular film. I added validations on the order form for most of the parameters. I am using a gem called ‘credit_card_validations’, which requires that the user enter in a real credit card number. Once the order is submitted a callback called ‘after_create’ on the order model is called. This callback triggers an email to the user. The email is sent out to the user with a receipt that shows their showtime, movie and price. I used SendGrid for the action mailer delivery method. 

As mentioned before I created an admin section for the Theatre owner where she will be able to manage her movies, showtimes, theatres and view the orders. Something I would really like to implement would be a dashboard that shows the theatre owner insights into her business based on the orders and showtimes, as well as adding configuration for flagging movies as matinee and setting the prices dynamically. 

The theatre owner is able to create movies through the ‘new movie’ button. (This is my favorite functionality of the app) Originally, I had added just a simple form that took the movie title and description, but I really wanted to implement an easy and quick way for the theatre owner to add movies with the correct attributes. I ended up adding attributes to the movies model so that it takes an imdb_id, poster image, rating, and trailer url. The idea was to have the user enter the imdb_id for the film and all other fields would be populated automatically. I searched online for an imdb ruby gem to communicate with the IMDB API and found one that seemed promising. I implemented a gem interface under the lib folder, which would make the request to find the movie with the imdb_id. I was able to implement this functionality but about an hour after implementation imdb had shut down my access to their API. Not wanting to change any of the functionality I searched for another gem for movie information, which is when I found OMDB, an open source movie database. I only had to change one line of code on the interface and a few methods and we were up and running again. The nice thing about the interface was that I only had to change the code in one place. OMDB worked well until again IMDB shut me down since OMDB uses IMDB for the poster images. Finally I found TMDB, a truly open source movie database and submitted approval for an API Key. This is how we are able to create movies with just the IMDB_ID. If the theatre owner wishes to not use the id she can fill out the other attributes on the form to create the movie. Try it out! Use IMDB_ID: tt0427229

The orders table shows all orders based on movie title and displays the showtime, customer name, customer email and the purchase amount. As the Theatre Owner you are able to choose a film from a dropdown of the current movies playing. Since we removed the dependent destroy on movies and showtimes with orders you are able to delete a movie and still keep the orders table and financial integrity. Movies that have been deleted are flagged with an exclamation icon on the first column. 

Given more time I would have liked to have had better test coverage on the application. Adding a Select2 search field for the IMDB integration so that it dynamically searches for the movie and the owner does not have to get the ID field. The owner being able to set up pricing, movie MPAA Rating validation for the customer’s age, and other configuration options for the application.

